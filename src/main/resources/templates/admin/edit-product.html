<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">

<head th:replace="layout/fragments :: include"></head>

<head th:replace="layout/fragments :: admin-include"></head>

<head>
    <title>Thêm sản phẩm mới</title>
</head>

<body>
    <nav class="navbar navbar-expand-xl">
        <div class="container h-100">
            <a class="navbar-brand" href="index.html">
                <h1 class="tm-site-title mb-0">Product Admin</h1>
            </a>
            <button class="navbar-toggler ml-auto mr-0" type="button" data-toggle="collapse"
                data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <i class="fas fa-bars tm-nav-icon"></i>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav mx-auto h-100">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">
                            <i class="fas fa-tachometer-alt"></i> Dashboard
                            <span class="sr-only">(current)</span>
                        </a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="far fa-file-alt"></i>
                            <span> Reports <i class="fas fa-angle-down"></i> </span>
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="#">Daily Report</a>
                            <a class="dropdown-item" href="#">Weekly Report</a>
                            <a class="dropdown-item" href="#">Yearly Report</a>
                        </div>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="products.html">
                            <i class="fas fa-shopping-cart"></i> Products
                        </a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="accounts.html">
                            <i class="far fa-user"></i> Accounts
                        </a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <i class="fas fa-cog"></i>
                            <span> Settings <i class="fas fa-angle-down"></i> </span>
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="#">Profile</a>
                            <a class="dropdown-item" href="#">Billing</a>
                            <a class="dropdown-item" href="#">Customize</a>
                        </div>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link d-block" href="login.html">
                            Admin, <b>Logout</b>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container tm-mt-big tm-mb-big">
        <div class="row">
            <div class="col-xl-9 col-lg-10 col-md-12 col-sm-12 mx-auto">
                <div class="tm-bg-primary-dark tm-block tm-block-h-auto">
                    <div class="row">
                        <div class="col-12">
                            <h2 class="tm-block-title d-inline-block">Chỉnh sửa sản phẩm</h2>
                        </div>
                    </div>
                    <div class="row tm-edit-product-row">
                        <div class="col-xl-6 col-lg-6 col-md-12">
                            <form th:data-id="${rice.id}" action="/admin/product/update/{id}" th:method="PUT"
                                class="tm-edit-product-form" enctype="multipart/form-data">
                                <div class="form-group mb-3">
                                    <label for="name">Tên sản phẩm
                                    </label>
                                    <input id="name" name="name" type="text" th:value="${rice.name}"
                                        class="form-control validate" />
                                </div>
                                <div class="form-group mb-3">
                                    <label for="description">Mô tả</label>
                                    <textarea name="description" class="form-control validate tm-small" rows="5"
                                        th:text="${rice.description}" required></textarea>
                                </div>
                                <div class="form-group mb-3">
                                    <label for="brand">Loại sản phẩm</label>
                                    <input type="text" name="brand" id="brand" class="form-control validate"
                                        th:value="${rice.brand}">
                                </div>
                                <div class="row">
                                    <div class="form-group mb-3 col-xs-12 col-sm-6">
                                        <label for="price">Giá
                                        </label>
                                        <input id="price" name="price" type="text" th:value="${rice.price}"
                                            class="form-control validate" data-large-mode="true" />
                                    </div>
                                    <div class="form-group mb-3 col-xs-12 col-sm-6">
                                        <label for="kilograms">Số lượng (Kg)
                                        </label>
                                        <input id="kilograms" name="kilograms" type="text" th:value="${rice.kilograms}"
                                            class="form-control validate" />
                                    </div>
                                </div>

                        </div>
                        <div class="col-xl-6 col-lg-6 col-md-12 mx-auto mb-4">
                            <div class="tm-product-img-edit mx-auto">
                                <img style="height: 230px;" th:src="${rice.image}" alt="Product image" class="img-fluid d-block mx-auto">
                                <i class="fas fa-cloud-upload-alt tm-upload-icon"
                                    onclick="document.getElementById('fileInput').click();"></i>
                            </div>
                            <div class="custom-file mt-3 mb-3">
                                <input id="fileInput" type="file" style="display:none;" name="image"
                                    onchange="renderImage(this)" th:value="${rice.image}" />
                                <input type="button" class="btn btn-primary btn-block mx-auto" value="CHANGE IMAGE NOW"
                                    onclick="document.getElementById('fileInput').click();" />
                            </div>
                        </div>
                        <div class="col-12">
                            <button type="submit" class="btn btn-primary btn-block text-uppercase">CẬP NHẬT
                                NGAY</button>
                        </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <footer class="tm-footer row tm-mt-small">
        <div class="col-12 font-weight-light">
            <p class="text-center text-white mb-0 px-4 small">
                Copyright &copy; <b>2018</b> All rights reserved.

                Design: <a rel="nofollow noopener" href="https://templatemo.com" class="tm-footer-link">Template Mo</a>
            </p>
        </div>
    </footer>

    <div class="admin-script" th:replace="layout/fragments :: admin-script"></div>

    <script>
        function renderImage(fileInput) {
            if (fileInput.files && fileInput.files[0]) {
                let reader = new FileReader();
                reader.onload = e => document.querySelector('img').setAttribute('src', e.target.result);
                reader.readAsDataURL(fileInput.files[0])
            }
        }

    </script>

    <script>
        const priceField = document.getElementById("price");
        const kilogramsField = document.getElementById("kilograms");

        let intPriceValue = parseInt(priceField.value, 10);
        let intKilogramsValue = parseInt(kilogramsField.value, 10);

        if (intPriceValue == priceField.value)
            priceField.value = intPriceValue;

        if (intKilogramsValue == kilogramsField.value)
            kilogramsField.value = intKilogramsValue;

    </script>

    <script>
        const updateForm = document.querySelector('form');
        const dataId = updateForm.getAttribute('data-id');
        let updateLink = updateForm.getAttribute('action');
        let trueUpdateLink = updateLink.replace("{id}", String(dataId));
        updateForm.setAttribute('action', trueUpdateLink);
        console.log(updateForm);
    </script>

</body>

</html>